if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}$(document).ready(function(){$("#promptInfo").bind("contentchanged",function(b){var a=$(b.target).html();if(a!=""&&a!="该账号已锁定，请稍后再试！"&&a.indexOf("身份验证错误")==-1){$("#promptInfo").html("用户名或密码或验证码错误，请重新输入！")}});$("#promptInfo").trigger("contentchanged");$("input").each(function(){var a=$(this);a.context.autoComplete="off"});if(self.frameElement!=null){window.parent.location.href=location.href}initPageConfigs();$("input").inputTip();$("input[type='checkbox']").focus();onLoadCookie();$("#loginForm").validate()});function formatStrTrim(a){a=a.replace(/\s/g,"");return a}function createWinLog(l,g,h,c){function e(n){var m=document.getElementById(n);if(!m){return false}else{return true}}function d(o){var n=/^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[!@#$%^&*])[0-9a-zA-Z!@#$%^&*]{6,16}$/;var m=n.test(o);if(m){return true}else{return false}}var i=e("createWinLogWX");if(i){$("#createWinLogWX").show();return}var k=$('<div id="createWinLogWX"></div>');var j=$(document).height(),b=$(document).width();k.css({position:"absolute",left:b/4+100,top:j/4-10,width:460,height:300,color:"white",border:"1px solid b4b4b4","font-family":"Microsoft Yahei","background-color":"#fff","border-radius":"5px","z-index":999});var a='<div style="background-color: #00a0e9; height: 30px; border-radius: 5px 5px 0 0;"><span class="fa fa-volume-up" style="padding: 5px 5px; font-size: 18px; margin-left: 10px;"><span style="font-family: microsoft yahei;">&nbsp;&nbsp;您好，'+h+'！</span></span> <i id="flowWinCloseWX" class="fa fa-times" aria-hidden="true" style="position: absolute; right: 10px; top: 8px; cursor: pointer; color: white;"></i></div>';a+='<span style="display: inline-block; color: red; font-family: Microsoft Yahei; font-size: 14px; margin: 10px 10px;">您的密码已过有效期（'+c+"），请先设置新密码！</span>";a+='<div style="margin: 20px 40px; color: #333; font-family: microsoft yahei; font-size: 18px;"><label>原密码:<span style="color: red;">*</span></label><input name="oldPsdWX" id="oldPsdWX" style="margin-left: 10px; border-radius: 2px; height: 30px; width: 65%; border: 1px solid gray;" type="password" placeholder="请输入原密码" /><table style="display: inline;"><tr style="display: inline-block; margin-top: 2px;"><td title="原密码错误"><b id="oriPCommit" style="display: in-line; visibility: hidden; color: red; margin: 0 10px;">！</b></td></tr></table></div>';a+='<div style="margin: 0px 40px; color: #333; font-family: microsoft yahei; font-size: 18px;"><label>新密码:<span style="color: red;">*</span></label><input name="newPsdWX" id="newPsdWX" style="margin-left: 10px; border-radius: 2px; height: 30px; width: 65%; border: 1px solid gray;" type="password" placeholder="6-16个字符，需包含字母，数字和特殊字符" /><table style="display: inline;"><tr style="display: inline-block; margin-top: 2px;"><td title="新密码格式不符合要求"><b id="newPCommit" style="display: in-line; visibility: hidden; color: red; margin: 0 10px;">！</b></td></tr></table></div>';a+='<div style="margin: 20px 20px; color: #333; font-family: microsoft yahei; font-size: 18px;"><label>确认密码:<span style="color: red;">*</span></label><input name="newPsdConfirmWX" id="newPsdConfirmWX" style="margin-left: 10px; border-radius: 2px; height: 30px; width: 59%; border: 1px solid gray;" type="password" placeholder="再次输入新密码" /><table style="display: inline;"><tr style="display: inline-block; margin-top: 2px;"><td title="两次输入密码不一致"><b aria-hidden="true" id="twicePCommit" style="display: in-line; visibility: hidden; color: red; margin: 0 10px;">！</b></td></tr></table></div>';a+='<div style="margin-left: auto; margin-right: auto; width: 34%; font-family: Microsoft Yahei; font-size: 18px; "><input type="button" id="savecreateWinLogWX" class="login_btn1 btn_style" style="font-family: Microsoft Yahei; background-color: #00a0e9; width: 50px; height: 30px; line-height: 30px; padding: 0; background: none; background-color: #00a0e9;" value="保存"/><input type="button" id="cancelcreateWinLogWX" class="login_btn2 btn_style" style="font-family: Microsoft Yahei; margin-left: 30px; width: 50px; height: 30px; line-height: 30px; padding: 0;" value="取消"/></div>';k.html(a);k.appendTo("body");$("#cancelcreateWinLogWX, #flowWinCloseWX").on("click",function(){$("#oldPsdWX").val("");$("#newPsdWX").val("");$("#newPsdConfirmWX").val("");$("#oriPCommit")[0].style.visibility="hidden";$("#newPCommit")[0].style.visibility="hidden";$("#twicePCommit")[0].style.visibility="hidden";$("#createWinLogWX").hide()});$("#savecreateWinLogWX").on("click",function(){f()});$("input[type=password]").keydown("click",function(m){if(m.which!==13){return}f()});function f(){var m=$("#oldPsdWX").val();var o=$("#newPsdWX").val();var n=$("#newPsdConfirmWX").val();if(hex_sha1(m)!=g){$("#oriPCommit")[0].style.visibility="visible";return}else{$("#oriPCommit")[0].style.visibility="hidden"}if(hex_sha1(m)==hex_sha1(o)){$("#newPCommit")[0].style.visibility="visible";$("#newPCommit").parent().attr("title","新密码和原密码相同");return}else{$("#newPCommit")[0].style.visibility="hidden"}if(hex_sha1(n)!=hex_sha1(o)){$("#twicePCommit")[0].style.visibility="visible";return}else{$("#twicePCommit")[0].style.visibility="hidden"}if(!d(o)){$("#newPCommit")[0].style.visibility="visible";$("#newPCommit").parent().attr("title","密码不符合格式要求");return}else{$("#newPCommit")[0].style.visibility="hidden"}saveUserInfoWX(l,hex_sha1(o),m)}}function saveUserInfoWX(c,d,b){var a="/sml/update/inas-cfg-pwd-update";$.ajax({url:eastcom.baseURL+a,type:"post",contentType:"application/json",data:JSON.stringify({username:c,password:d})}).done(function(e){alert("设置新密码成功，请重新登录！");$("#createWinLogWX").hide();$("#userPassword").val("");$("#verification_code").val("")})}function formReset(){$("#username").val("").focus().blur();$("#password").val("").focus().blur();$("#codeImg").val("").focus().blur();$("#promptInfo").text(" ").attr("title","")}function ChangeCode(a){var b=$("#"+a);b.attr("src",b.attr("src")+"?temp="+(new Date().getTime().toString(36)))}function initPageConfigs(){var a=function(b){$.each(b.defaultLoginConfig,function(d,e){if(e.name=="loginFootInfo"){document.getElementById("loginFootInfo").innerHTML=e.value}else{if(e.name=="contaction"){document.getElementById("contaction").innerHTML=e.value}else{if(e.name=="logintitle"){var c=$("#logintitle");c.css({background:"url("+eastcom.baseURL+e.value+")"})}}}})};jQuery.ajax({type:"POST",async:true,dataType:"json",url:eastcom.baseURL+"/projectInfo-unAuth/getLoginPageConfig",data:{types:"LM"},success:function(b){a(b.data)},error:function(b,d,c){}})};