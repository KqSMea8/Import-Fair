define("common:widget/apiext/infowindowoverlay.js",function(i,t,s){function e(){this.type=0,this.point=null,this.json={},this.points={},this.cityCode=null,this.index=-1,this.offsetX=0,this.offsetY=0,this.visible=!1}var n=i("mapapi:widget/api/api.js"),o=i("core:widget/pagemgr/pagemgr.js");e.prototype=new n.Overlay,$.extend(e.prototype,{initialize:function(i,t){this._map=i;var s=this.container=this._createContainer(t);this.create(t),i.getPanes().floatPane.appendChild(s),$(s).parent().css({"z-index":800}),this._bindEvent()},_createContainer:function(i){return $("<ul />",{"class":"iw-ct "+(i&&i.className||"")}).get(0)},create:function(){return $(this.container).append($('<li><i class="icon -search"></i></li>',{"class":"iw-l -vcenter",css:{display:""},"data-iw-id":"iw-l"})).append($("<li />",{"class":"iw-c","data-iw-id":"iw-c"})).append($('<li><i class="icon -route"></i></li>',{"class":"iw-r -vcenter",css:{display:""},"data-iw-id":"iw-r"}))},_bindEvent:function(){var i=this,t=$(this.container).find("li"),s=o.isSinglePageApp()?"click":"tap";t.on(s,function(t){i.visible&&listener.trigger("infowindow."+i.type,"click",{id:$(t.target).data("iw-id")||$(t.target).parents("[data-iw-id]").data("iw-id"),data:i.getData(i.type,i.index),instance:i})}),t.on("touchstart",function(t){t.touches&&t.touches.length>1?t.cancelBubble=!0:i.handled=!0})},setData:function(i,t){return this.type=i,t.json&&(this.json[i]=t.json),t.points&&(this.points[i]=t.points),t.cityCode&&(this.cityCode=t.cityCode),(t.showPop||0==t.showPop)&&(this.showPop=t.showPop),this},getData:function(i,t){var s=this.json[i];if(s)return t>-1&&void 0!==s[t]?s[t]:s},hide:function(){$(this.container).hide(),this.visible=!1},show:function(i){$(this.container).css({visibility:"hidden"}).show(),this.html().draw(),$(this.container).css({visibility:""}),this.visible=!0,i&&($(this.container).css({visibility:"hidden"}),this.visible=!1);var t=this;this.timer||(this.timer=setTimeout(function(){t.setPosition(),clearTimeout(t.timer),t.timer=null},100))},html:function(i){var t=$(this.container),s=t.find(".iw-c");return s.html(i||this.content),this.width=t.width(),this.height=t.height(),this},draw:function(){var i=$(this.container),t=8,s=this.width/2+(this.offsetX||0),e=this.height+t+(this.offsetY||0);if(this.point){var n=this._map.pointToOverlayPixel(this.point),o=n.x-s,a=n.y-e;i.css({left:o+"px",top:a+"px"})}},setPosition:function(){if(this.point){var i=this._map,t=this.point,s=i.pointToPixel(t),e=new n.Pixel(0,0),o=i.getSize(),a=this.width/2+16,h=this.height/2+78;s.x<a?e.x=a-s.x:o.width-s.x-8<a&&(e.x=o.width-s.x-8-a),s.y<h?e.y=h-s.y:o.height-s.y<60&&(e.y=o.height-s.y-60),i.panBy(e.x,e.y)}}}),e._className_="InfoWindowOverlay",s.exports=e});